from pwn import xor

with open('id_rsa_priv', 'rb') as f:
    all_bytes = bytearray(f.read())

start_bytes = all_bytes[:32]

start_plain = b'-----BEGIN OPENSSH PRIVATE KEY-----\n'[:32]    # 32 bytes
# print(len(start_plain))
xor_key = b''
for i in range(len(start_bytes)):
    
    xor_char = xor(start_bytes[i], start_plain[i])
    print(xor_char, end=' ')
    xor_key += xor_char


print('\nxor_key: ', xor_key)

FILE = 'Welcome Aboard'
EXT = 'pdf'

with open(FILE, 'rb') as f:
    all_bytes = bytearray(f.read())

# print(all_bytes)

all_plain = b''
for i in range(len(all_bytes)):
    plain_char = xor(xor_key[i%32], all_bytes[i])
    all_plain += plain_char

print(all_plain)

with open(f'{FILE}.{EXT}', 'wb') as f:
    f.write(all_plain)